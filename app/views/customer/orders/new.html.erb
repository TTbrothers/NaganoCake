<% provide(:title, "注文情報入力") %>
<div class="container">
  <div class="row">
   <div class="col-xs-12">
    <h2 class="head-line title_h2 text-center">注文情報入力</h2>
   </div>
  </div>
   <% if current_customer.cart_items.present? %>

<!--エラーメッセージ-->
   <% if @order.errors.any? %>
   <div id="error_explanation">
    <h2>
     <%= I18n.t("errors.messages.not_saved",
                 count: @order.errors.count,
                 resource: @order.class.model_name.human.downcase)
       %>
    </h2>
    <ul>
     <% @order.errors.full_messages.each do |message| %>
    <li><%= message %></li>
    <% end %>
    </ul>
   </div>
   <% end %>

   <div class="row">
    <%= form_with :model => @order, url: customer_orders_comfirm_path, method: :post, local: true  do |f| %>
     <h4 class="col">支払い方法</h4>


      <div class="col-xs-10 radio">
       <%= f.radio_button :payment_method, :"クレジットカード", checked: true %>
       <span>&nbsp;クレジットカード</span>
      </div>
      <div class="col-xs-10 radio">
       <%= f.radio_button :payment_method, :"銀行振込" %>
       <span>&nbsp;銀行振り込み</span>

      </div>
      </div>

     <h4 class="col">お届け先</h4>
      <div class="col-xs-10 radio">
       <%= f.radio_button :addresses, "residense", checked: true  %>
       <span>&nbsp;ご自身の住所</span><br>
          &emsp;&emsp;<%= "〒#{current_customer.postal_code} #{current_customer.address}" %>
          <br>
          &emsp;&emsp;<%= " #{current_customer.last_name} #{current_customer.first_name}" %>
      </div>

      <% if @shipping_addresses != [] %>
       <div class="col-xs-10 radio">
        <%= f.radio_button :addresses, "shipping_addresses" %>
        <span>&nbsp;登録済住所から選択</span><br>
        <!--order_addressはshipping_addressのモデルでpostal_code+address+name-->
         &emsp;&emsp;<%= f.collection_select(:shipping_address_id, @shipping_addresses, :id, :address) %>
       </div>
       <% end %>

       <div class="new-address">
        <%= f.radio_button :addresses, "new_address" %>
        <span>&nbsp;新しいお届け先</span><br>
        <div class="row">
        <table class="table table-borderless">
        <tr>
         <th><%= f.label :"郵便番号(ハイフンなし)"%></th>
         <td><%= f.text_field :postal_code, class: "col-sm-3 form-control-static postal_code" %></td>
         <td></td>
        </tr>
        <tr>
         <th><%= f.label :"住所" %></th>
         <td><%= f.text_field :address, class: "col-sm-8 form-control-static address" %></td>
         <td></td>
        </tr>
        <tr>
         <th><%= f.label :"宛名" %></th>
         <td><%= f.text_field :name, class: "col-sm-4 form-control-static" %></td>
         <td></td>
        </tr>

        </table>
        </div>
        </div>
        <div class="row" style="display: flex; justify-content: center;">
        <%= f.submit "確認画面へ進む", class: "btn btn-primary col-xs-5" %>

        </div>

         <%#= link_to cart_items_path, class: "glyphicon glyphicon-shopping-cart btn btn-info col-xs-3 cart-back" do %>
          <!--カート(<%#= current_customer.cart_items.count %>)へ戻る-->
         <%# end %>
       <% end %>

   <% else %>
      <!-- if カートアイテムがない時 -->
      <p>お客様のショッピングカートに商品はありませんので注文情報の入力ができません。</p>
      <p><%= link_to "商品一覧", customer_items_path, class: "btn btn-warning" %>から商品をお探し下さい。</p>
   <% end %>


</div>